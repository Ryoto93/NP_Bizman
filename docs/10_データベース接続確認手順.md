# データベース接続確認手順

## 現在の状況

データベース接続エラーが発生しています：
```
Can't reach database server at `db.fgnbfczmvsauzmzjuhpl.supabase.co:5432`
```

## 確認事項

### 1. `.env.local`の`DATABASE_URL`確認

以下の形式であることを確認してください：

```bash
# 通常の接続文字列（直接接続）
DATABASE_URL=postgresql://postgres:[PASSWORD]@db.fgnbfczmvsauzmzjuhpl.supabase.co:5432/postgres

# または接続プーリング用（推奨）
DATABASE_URL=postgresql://postgres.[PROJECT_REF]:[PASSWORD]@aws-0-ap-northeast-1.pooler.supabase.com:6543/postgres
```

**重要**：
- `[PASSWORD]`を実際のデータベースパスワードに置き換える
- `[PROJECT_REF]`は`fgnbfczmvsauzmzjuhpl`（既にURLに含まれている場合は不要）

### 2. Supabaseダッシュボードで接続文字列を確認

1. Supabaseダッシュボードにアクセス
2. Settings > Database に移動
3. Connection string セクションを確認
4. **Connection pooling**タブを選択（推奨）
5. **URI**を選択してコピー

### 3. プロジェクトがアクティブか確認

Supabaseダッシュボードでプロジェクトが起動していることを確認してください。

### 4. 接続テスト

接続文字列を確認後、以下のコマンドでテスト：

```bash
npx tsx scripts/test-db-connection.ts
```

## MCPサーバーを使ったテーブル作成

データベース接続に問題がある場合でも、MCPサーバーはSupabaseプロジェクトに直接接続するため、テーブル作成は可能です。

MCPサーバーに以下の情報を提供してテーブルを作成してください：

- **Project Reference**: `fgnbfczmvsauzmzjuhpl`
- **Prisma Schema**: `prisma/schema.prisma` ファイルの内容

詳細は `supabase-table-creation-instruction.md` を参照してください。

